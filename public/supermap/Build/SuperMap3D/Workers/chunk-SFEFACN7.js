import{b as fa}from"./chunk-L6Z5JM56.js";import{b as ua}from"./chunk-RMFPWQ3G.js";import{a as j}from"./chunk-L77WLOIG.js";import{a as K,b as ma,c as ea}from"./chunk-YOUPUNCB.js";import{a as ra}from"./chunk-RRHLFRBE.js";import{a as d}from"./chunk-JTWCWMT6.js";import{a as ta}from"./chunk-3CEYC7M5.js";import{a as T,b as va}from"./chunk-SVO3L3ZS.js";import{a as Q}from"./chunk-ZCGLU37G.js";import{b as N}from"./chunk-E37TXANJ.js";import{a}from"./chunk-DJQWO2NJ.js";import{a as E}from"./chunk-Y2ETSBLW.js";import{a as V}from"./chunk-UBHQMGET.js";import{a as G}from"./chunk-EDZQSM3T.js";import{a as P}from"./chunk-PJGSCWXZ.js";import{a as l}from"./chunk-NUC3LT2W.js";var f=[];f[0]={num:0,des:"inside"};f[1]={num:4,data:[0,4,7,3],des:"left"};f[2]={num:4,data:[1,2,6,5],des:"right"};f[3]={num:0};f[4]={num:4,data:[0,1,5,4],des:"bottom"};f[5]={num:6,data:[0,1,5,4,7,3],des:"bottom, left"};f[6]={num:6,data:[0,1,2,6,5,4],des:"bottom, right"};f[7]={num:0};f[8]={num:4,data:[2,3,7,6],des:"top"};f[9]={num:6,data:[4,7,6,2,3,0],des:"top, left"};f[10]={num:6,data:[2,3,7,6,5,1],des:"top, right"};f[11]={num:0};f[12]={num:0};f[13]={num:0};f[14]={num:0};f[15]={num:0};f[16]={num:4,data:[0,3,2,1],des:"front"};f[17]={num:6,data:[0,4,7,3,2,1],des:"front, left"};f[18]={num:6,data:[0,3,2,6,5,1],des:"front, right"};f[19]={num:0};f[20]={num:6,data:[0,3,2,1,5,4],des:"front, bottom"};f[21]={num:6,data:[2,1,5,4,7,3],des:"front, bottom, left"};f[22]={num:6,data:[0,3,2,6,5,4],des:"front, bottom, right"};f[23]={num:0};f[24]={num:6,data:[0,3,7,6,2,1],des:"front, top"};f[25]={num:6,data:[0,4,7,6,2,1],des:"front, top, left"};f[26]={num:6,data:[0,3,7,6,5,1],des:"front, top, right"};f[27]={num:0};f[28]={num:0};f[29]={num:0};f[30]={num:0};f[31]={num:0};f[32]={num:4,data:[4,5,6,7],des:"back"};f[33]={num:6,data:[4,5,6,7,3,0],des:"back, left"};f[34]={num:6,data:[1,2,6,7,4,5],des:"back, right"};f[35]={num:0};f[36]={num:6,data:[0,1,5,6,7,4],des:"back, bottom"};f[37]={num:6,data:[0,1,5,6,7,3],des:"back, bottom, left"};f[38]={num:6,data:[0,1,2,6,7,4],des:"back, bottom, right"};f[39]={num:0};f[40]={num:6,data:[2,3,7,4,5,6],des:"back, top"};f[41]={num:6,data:[0,4,5,6,2,3],des:"back, top, left"};f[42]={num:6,data:[1,2,3,7,4,5],des:"back, top, right"};function p(t,r){this.center=a.clone(V(t,a.ZERO)),this.halfAxes=d.clone(V(r,d.ZERO)),this.areaDirty=1}p.packedLength=a.packedLength+d.packedLength;p.pack=function(t,r,e){return G.typeOf.object("value",t),G.defined("array",r),e=V(e,0),a.pack(t.center,r,e),d.pack(t.halfAxes,r,e+a.packedLength),r};p.unpack=function(t,r,e){return G.defined("array",t),r=V(r,0),l(e)||(e=new p),a.unpack(t,r,e.center),d.unpack(t,r+a.packedLength,e.halfAxes),e};var Na=new a,Ta=new a,Ra=new a,Ca=new a,ba=new a,Ma=new a,Ba=new d,Pa={unitary:new d,diagonal:new d},U=new a,I=new a,y=new a;p.fromPoints=function(t,r){if(l(r)||(r=new p),!l(t)||t.length===0)return r.halfAxes=d.ZERO,r.center=a.ZERO,r;var e,h=t.length,c=a.clone(t[0],Na);for(e=1;e<h;e++)a.add(c,t[e],c);var i=1/h;a.multiplyByScalar(c,i,c);var m=0,x=0,w=0,u=0,s=0,n=0,o;for(e=0;e<h;e++)o=a.subtract(t[e],c,Ta),m+=o.x*o.x,x+=o.x*o.y,w+=o.x*o.z,u+=o.y*o.y,s+=o.y*o.z,n+=o.z*o.z;m*=i,x*=i,w*=i,u*=i,s*=i,n*=i;var v=Ba;v[0]=m,v[1]=x,v[2]=w,v[3]=x,v[4]=u,v[5]=s,v[6]=w,v[7]=s,v[8]=n;var C=d.computeEigenDecomposition(v,Pa),R=d.clone(C.unitary,r.halfAxes),z=d.getColumn(R,0,Ca),A=d.getColumn(R,1,ba),O=d.getColumn(R,2,Ma),M=-Number.MAX_VALUE,b=-Number.MAX_VALUE,k=-Number.MAX_VALUE,S=Number.MAX_VALUE,L=Number.MAX_VALUE,B=Number.MAX_VALUE;for(e=0;e<h;e++)o=t[e],M=Math.max(a.dot(z,o),M),b=Math.max(a.dot(A,o),b),k=Math.max(a.dot(O,o),k),S=Math.min(a.dot(z,o),S),L=Math.min(a.dot(A,o),L),B=Math.min(a.dot(O,o),B);z=a.multiplyByScalar(z,.5*(S+M),z),A=a.multiplyByScalar(A,.5*(L+b),A),O=a.multiplyByScalar(O,.5*(B+k),O);var D=a.add(z,A,r.center);a.add(D,O,D);var g=Ra;return g.x=M-S,g.y=b-L,g.z=k-B,a.multiplyByScalar(g,.5,g),d.multiplyByScale(r.halfAxes,g,r.halfAxes),r};var za=new a,Ia=new a;function wa(t,r,e,h,c,i,m,x,w,u,s){if(!l(c)||!l(i)||!l(m)||!l(x)||!l(w)||!l(u))throw new P("all extents (minimum/maximum X/Y/Z) are required.");l(s)||(s=new p);var n=s.halfAxes;d.setColumn(n,0,r,n),d.setColumn(n,1,e,n),d.setColumn(n,2,h,n);var o=za;o.x=(c+i)/2,o.y=(m+x)/2,o.z=(w+u)/2;var v=Ia;v.x=(i-c)/2,v.y=(x-m)/2,v.z=(u-w)/2;var C=s.center;return o=d.multiplyByVector(n,o,o),a.add(t,o,C),d.multiplyByScale(n,v,n),s}var pa=new N,Sa=new a,La=new N,qa=new N,ka=new N,Da=new N,Ua=new N,Va=new a,xa=new a,Xa=new a,ya=new a,ja=new a,Wa=new T,_a=new T,Za=new T,Ya=new T,Fa=new T,Ga=new a,Ja=new a,Ka=new a,Qa=new a,$a=new T,Ha=new a,ar=new a,rr=new a,tr=new j(a.UNIT_X,0);p.fromRectangle=function(t,r,e,h,c){if(!l(t))throw new P("rectangle is required");if(t.width<0||t.width>E.TWO_PI)throw new P("Rectangle width must be between 0 and 2*pi");if(t.height<0||t.height>E.PI)throw new P("Rectangle height must be between 0 and pi");if(l(h)&&!E.equalsEpsilon(h.radii.x,h.radii.y,E.EPSILON15))throw new P("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");r=V(r,0),e=V(e,0),h=V(h,va.WGS84);var i,m,x,w,u,s,n;if(t.width<=E.PI){var o=ta.center(t,pa),v=h.cartographicToCartesian(o,Sa),C=new fa(v,h);n=C.plane;var R=o.longitude,z=t.south<0&&t.north>0?0:o.latitude,A=N.fromRadians(R,t.north,e,La),O=N.fromRadians(t.west,t.north,e,qa),M=N.fromRadians(t.west,z,e,ka),b=N.fromRadians(t.west,t.south,e,Da),k=N.fromRadians(R,t.south,e,Ua),S=h.cartographicToCartesian(A,Va),L=h.cartographicToCartesian(O,xa),B=h.cartographicToCartesian(M,Xa),D=h.cartographicToCartesian(b,ya),g=h.cartographicToCartesian(k,ja),Z=C.projectPointToNearestOnPlane(S,Wa),X=C.projectPointToNearestOnPlane(L,_a),q=C.projectPointToNearestOnPlane(B,Za),Y=C.projectPointToNearestOnPlane(D,Ya),J=C.projectPointToNearestOnPlane(g,Fa);return i=Math.min(X.x,q.x,Y.x),m=-i,w=Math.max(X.y,Z.y),x=Math.min(Y.y,J.y),O.height=b.height=r,L=h.cartographicToCartesian(O,xa),D=h.cartographicToCartesian(b,ya),u=Math.min(j.getPointDistance(n,L),j.getPointDistance(n,D)),s=e,wa(C.origin,C.xAxis,C.yAxis,C.zAxis,i,m,x,w,u,s,c)}var F=t.south>0,ia=t.north<0,H=F?t.south:ia?t.north:0,sa=ta.center(t,pa).longitude,_=a.fromRadians(sa,H,e,h,Ga);_.z=0;var Oa=Math.abs(_.x)<E.EPSILON10&&Math.abs(_.y)<E.EPSILON10,aa=Oa?a.UNIT_X:a.normalize(_,Ja),ha=a.UNIT_Z,da=a.cross(aa,ha,Ka);n=j.fromPointNormal(_,aa,tr);var ga=a.fromRadians(sa+E.PI_OVER_TWO,H,e,h,Qa);m=a.dot(j.projectPointOntoPlane(n,ga,$a),da),i=-m,w=a.fromRadians(0,t.north,ia?r:e,h,Ha).z,x=a.fromRadians(0,t.south,F?r:e,h,ar).z;var Ea=a.fromRadians(t.east,H,e,h,rr);return u=j.getPointDistance(n,Ea),s=0,wa(_,da,ha,aa,i,m,x,w,u,s,c)};p.clone=function(t,r){if(!!l(t))return l(r)?(a.clone(t.center,r.center),d.clone(t.halfAxes,r.halfAxes),r.areaDirty=1,r):new p(t.center,t.halfAxes)};p.intersectPlane=function(t,r){if(!l(t))throw new P("box is required.");if(!l(r))throw new P("plane is required.");var e=t.center,h=r.normal,c=t.halfAxes,i=h.x,m=h.y,x=h.z,w=Math.abs(i*c[d.COLUMN0ROW0]+m*c[d.COLUMN0ROW1]+x*c[d.COLUMN0ROW2])+Math.abs(i*c[d.COLUMN1ROW0]+m*c[d.COLUMN1ROW1]+x*c[d.COLUMN1ROW2])+Math.abs(i*c[d.COLUMN2ROW0]+m*c[d.COLUMN2ROW1]+x*c[d.COLUMN2ROW2]),u=a.dot(h,e)+r.distance;return u<=-w?K.OUTSIDE:u>=w?K.INSIDE:K.INTERSECTING};var na=new a,oa=new a,ca=new a,er=new a,nr=new a;p.distanceSquaredTo=function(t,r){if(!l(t))throw new P("box is required.");if(!l(r))throw new P("cartesian is required.");var e=a.subtract(r,t.center,za),h=t.halfAxes,c=d.getColumn(h,0,na),i=d.getColumn(h,1,oa),m=d.getColumn(h,2,ca),x=a.magnitude(c),w=a.magnitude(i),u=a.magnitude(m);a.normalize(c,c),a.normalize(i,i),a.normalize(m,m);var s=er;s.x=a.dot(e,c),s.y=a.dot(e,i),s.z=a.dot(e,m);var n=0,o;return s.x<-x?(o=s.x+x,n+=o*o):s.x>x&&(o=s.x-x,n+=o*o),s.y<-w?(o=s.y+w,n+=o*o):s.y>w&&(o=s.y-w,n+=o*o),s.z<-u?(o=s.z+u,n+=o*o):s.z>u&&(o=s.z-u,n+=o*o),n};var Aa=new a,or=new a;p.computePlaneDistances=function(t,r,e,h){if(!l(t))throw new P("box is required.");if(!l(r))throw new P("position is required.");if(!l(e))throw new P("direction is required.");l(h)||(h=new ma);var c=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,m=t.center,x=t.halfAxes,w=d.getColumn(x,0,na),u=d.getColumn(x,1,oa),s=d.getColumn(x,2,ca),n=a.add(w,u,Aa);a.add(n,s,n),a.add(n,m,n);var o=a.subtract(n,r,or),v=a.dot(e,o);return c=Math.min(v,c),i=Math.max(v,i),a.add(m,w,n),a.add(n,u,n),a.subtract(n,s,n),a.subtract(n,r,o),v=a.dot(e,o),c=Math.min(v,c),i=Math.max(v,i),a.add(m,w,n),a.subtract(n,u,n),a.add(n,s,n),a.subtract(n,r,o),v=a.dot(e,o),c=Math.min(v,c),i=Math.max(v,i),a.add(m,w,n),a.subtract(n,u,n),a.subtract(n,s,n),a.subtract(n,r,o),v=a.dot(e,o),c=Math.min(v,c),i=Math.max(v,i),a.subtract(m,w,n),a.add(n,u,n),a.add(n,s,n),a.subtract(n,r,o),v=a.dot(e,o),c=Math.min(v,c),i=Math.max(v,i),a.subtract(m,w,n),a.add(n,u,n),a.subtract(n,s,n),a.subtract(n,r,o),v=a.dot(e,o),c=Math.min(v,c),i=Math.max(v,i),a.subtract(m,w,n),a.subtract(n,u,n),a.add(n,s,n),a.subtract(n,r,o),v=a.dot(e,o),c=Math.min(v,c),i=Math.max(v,i),a.subtract(m,w,n),a.subtract(n,u,n),a.subtract(n,s,n),a.subtract(n,r,o),v=a.dot(e,o),c=Math.min(v,c),i=Math.max(v,i),h.start=c,h.stop=i,h};var cr=new ea;p.isOccluded=function(t,r){if(!l(t))throw new P("box is required.");if(!l(r))throw new P("occluder is required.");var e=ea.fromOrientedBoundingBox(t,cr);return!r.isBoundingSphereVisible(e)};p.prototype.intersectPlane=function(t){return p.intersectPlane(this,t)};p.prototype.distanceSquaredTo=function(t){return p.distanceSquaredTo(this,t)};p.prototype.computePlaneDistances=function(t,r,e){return p.computePlaneDistances(this,t,r,e)};p.prototype.isOccluded=function(t){return p.isOccluded(this,t)};p.equals=function(t,r){return t===r||l(t)&&l(r)&&a.equals(t.center,r.center)&&d.equals(t.halfAxes,r.halfAxes)};p.prototype.clone=function(t){return p.clone(this,t)};p.prototype.equals=function(t){return p.equals(this,t)};var la=new Q;p.prototype._updateBBox=function(){if(this.areaDirty==1){var t=d.getColumn(this.halfAxes,0,na),r=a.clone(a.negate(t,U)),e=d.getColumn(this.halfAxes,1,oa),h=a.clone(a.negate(e,U)),c=d.getColumn(this.halfAxes,2,ca),i=a.clone(a.negate(c,U));this.bbox=[],a.add(this.center,e,U),a.add(U,i,I),a.add(I,r,y),this.bbox[0]=new a(y.x,y.y,y.z),a.add(I,t,y),this.bbox[1]=new a(y.x,y.y,y.z),a.add(U,c,I),a.add(I,t,y),this.bbox[2]=new a(y.x,y.y,y.z),a.add(I,r,y),this.bbox[3]=new a(y.x,y.y,y.z),a.add(this.center,h,U),a.add(U,i,I),a.add(I,r,y),this.bbox[4]=new a(y.x,y.y,y.z),a.add(I,t,y),this.bbox[5]=new a(y.x,y.y,y.z),a.add(U,c,I),a.add(I,t,y),this.bbox[6]=new a(y.x,y.y,y.z),a.add(I,r,y),this.bbox[7]=new a(y.x,y.y,y.z);var m=a.magnitude(t),x=a.magnitude(e),w=a.magnitude(c),u=new a(-m,-x,-w),s=new a(m,x,w);if(m*x*w==0){this.areaDirty=-1;return}a.normalize(t,t),a.normalize(e,e),a.normalize(c,c),this.u=a.clone(t),this.v=a.clone(e),this.w=a.clone(c),this.posMin=u,this.posMaX=s,this.halfDiagonalLine=.5*a.distance(s,u),this.areaDirty=0}};var W=[];W.push(new T);W.push(new T);W.push(new T);W.push(new T);W.push(new T);W.push(new T);var ir=new N,$=new a;p.prototype.calculateBoxArea=function(t,r,e,h,c,i,m,x){this._updateBBox();var w=t,u=a.subtract(w,this.center,nr);if(this.areaDirty==-1){var s=i!=-1?i:a.distance(this.posMaX,this.posMin)*.5,n=c,o=n/h,v=o*s/e;return E.PI*v*v}var C=a.fromElements(a.dot(u,this.u),a.dot(u,this.v),a.dot(u,this.w),Aa),R=C.x<this.posMin.x?1:0,z=C.x>this.posMaX.x?1:0,A=C.z<this.posMin.z?1:0,O=C.z>this.posMaX.z?1:0,M=C.y>this.posMaX.y?1:0,b=C.y<this.posMin.y?1:0,k=R+(z<<1)+(A<<2)+(O<<3)+(M<<4)+(b<<5);if(k>42)return console.log("area calculation is wrong"),-100;var S=f[k];if(S.num==0){var s=i!=-1?i:a.distance(this.posMaX,this.posMin)*.5,n=c,o=n/h,v=o*s/e;return E.PI*v*v}if(S.num==0)return console.log("area calculation is wrong"),-100;for(var L=[],B,D=m,g=0;g<S.num;g++){var Z=W[g],X=this.bbox[S.data[g]];B=!1;var q,Y=E.PI;if(r===3)q=ra.multiplyByVector(D,Q.fromElements(X.x,X.y,X.z,1),la),q.z<0&&(B=!0,s==-1&&(Y=E.PI_OVER_FOUR,e=a.magnitude(u)));else{var J=x,F=J.ellipsoid.cartesianToCartographic(X,ir);l(F)?(J.project(F,$),q=ra.multiplyByVector(D,Q.fromElements($.z,$.x,$.y,1),la),q.z<0&&(B=!0)):B=!0}if(B==!0){var s=i!=-1?i:a.distance(this.posMaX,this.posMin)*.5,n=c,o=n/h,v=o*s/e;return Y*v*v}else Z.x=q.x/q.w,Z.y=c-q.y/q.w,L.push(Z)}return Math.abs(ua.computeArea2D(L))};p.prototype.computeCorners=function(t){return p.computeCorners(this,t)};var sr=new a,hr=new a,dr=new a;p.computeCorners=function(t,r){G.typeOf.object("box",t),l(r)||(r=[new a,new a,new a,new a,new a,new a,new a,new a]);let e=t.center,h=t.halfAxes,c=d.getColumn(h,0,sr),i=d.getColumn(h,1,hr),m=d.getColumn(h,2,dr);return a.clone(e,r[0]),a.subtract(r[0],c,r[0]),a.subtract(r[0],i,r[0]),a.subtract(r[0],m,r[0]),a.clone(e,r[1]),a.subtract(r[1],c,r[1]),a.subtract(r[1],i,r[1]),a.add(r[1],m,r[1]),a.clone(e,r[2]),a.subtract(r[2],c,r[2]),a.add(r[2],i,r[2]),a.subtract(r[2],m,r[2]),a.clone(e,r[3]),a.subtract(r[3],c,r[3]),a.add(r[3],i,r[3]),a.add(r[3],m,r[3]),a.clone(e,r[4]),a.add(r[4],c,r[4]),a.subtract(r[4],i,r[4]),a.subtract(r[4],m,r[4]),a.clone(e,r[5]),a.add(r[5],c,r[5]),a.subtract(r[5],i,r[5]),a.add(r[5],m,r[5]),a.clone(e,r[6]),a.add(r[6],c,r[6]),a.add(r[6],i,r[6]),a.subtract(r[6],m,r[6]),a.clone(e,r[7]),a.add(r[7],c,r[7]),a.add(r[7],i,r[7]),a.add(r[7],m,r[7]),r};function vr(t,r){return new d(t.x*r.x,t.x*r.y,t.x*r.z,t.y*r.x,t.y*r.y,t.y*r.z,t.z*r.x,t.z*r.y,t.z*r.z)}p.fromOrientedBoundingBoxs=function(t,r){if(l(r)||(r=new p),!l(t)||t.length===0)return r;let e=[];t.forEach(M=>{let b=this.computeCorners(M);e=e.concat(b)});let h=new a;e.forEach(M=>{a.add(M,h,h)}),a.multiplyByScalar(h,1/e.length,h);let c=new d;e.forEach(M=>{let b=a.subtract(M,h,new a);c=d.add(vr(b,b),c,c)}),d.multiplyByScalar(c,1/(e.length-1),c);let i=d.computeEigenDecomposition(c,Pa);var m=d.clone(i.unitary,r.halfAxes),x=d.getColumn(m,0,Ca),w=d.getColumn(m,1,ba),u=d.getColumn(m,2,Ma);let s=[x,w,u],n=d.fromColumnMajorArray([s[0].x,s[1].x,s[2].x,s[0].y,s[1].y,s[2].y,s[0].z,s[1].z,s[2].z]),o=1/0,v=-1/0,C=1/0,R=-1/0,z=1/0,A=-1/0;e.forEach(M=>{let b=d.multiplyByVector(d.transpose(n,new d),a.subtract(M,h,new a),new a);o=Math.min(o,b.x),v=Math.max(v,b.x),C=Math.min(C,b.y),R=Math.max(R,b.y),z=Math.min(z,b.z),A=Math.max(A,b.z)}),r.center=h;var O=new a((v-o)/2,(R-C)/2,(A-z)/2);return d.multiplyByScale(r.halfAxes,O,r.halfAxes),r};var Rr=p;export{Rr as a};
