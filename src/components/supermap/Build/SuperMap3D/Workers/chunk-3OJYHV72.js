import{a as E}from"./chunk-RYEDLSXB.js";import{a as u}from"./chunk-L77WLOIG.js";import{a as se}from"./chunk-UIA2BV6O.js";import{c as A,g as _e,h as $}from"./chunk-T3RVX7V2.js";import{a as B,c as ve}from"./chunk-YOUPUNCB.js";import{a as we}from"./chunk-QO3RRUEO.js";import{a as b}from"./chunk-RRHLFRBE.js";import{a as X}from"./chunk-SRPTWKHW.js";import{a as W}from"./chunk-JTWCWMT6.js";import{a as g}from"./chunk-ZCGLU37G.js";import{a}from"./chunk-DJQWO2NJ.js";import{a as F}from"./chunk-Y2ETSBLW.js";import{a as d}from"./chunk-UBHQMGET.js";import{a as M}from"./chunk-EDZQSM3T.js";import{a as s}from"./chunk-PJGSCWXZ.js";import{a as o}from"./chunk-NUC3LT2W.js";function q(e){this.planes=d(e,[])}var te=[new a,new a,new a];a.clone(a.UNIT_X,te[0]);a.clone(a.UNIT_Y,te[1]);a.clone(a.UNIT_Z,te[2]);var L=new a,Fe=new a,le=new u(new a(1,0,0),0);q.fromBoundingSphere=function(e,t){if(!o(e))throw new s("boundingSphere is required.");o(t)||(t=new q);var i=te.length,f=t.planes;f.length=2*i;for(var h=e.center,w=e.radius,_=0,m=0;m<i;++m){var r=te[m],n=f[_],y=f[_+1];o(n)||(n=f[_]=new g),o(y)||(y=f[_+1]=new g),a.multiplyByScalar(r,-w,L),a.add(h,L,L),n.x=r.x,n.y=r.y,n.z=r.z,n.w=-a.dot(r,L),a.multiplyByScalar(r,w,L),a.add(h,L,L),y.x=-r.x,y.y=-r.y,y.z=-r.z,y.w=-a.dot(a.negate(r,Fe),L),_+=2}return t};q.prototype.computeVisibility=function(e){if(!o(e))throw new s("boundingVolume is required.");for(var t=this.planes,i=!1,f=0,h=t.length;f<h;++f){var w=e.intersectPlane(u.fromCartesian4(t[f],le));if(w===B.OUTSIDE)return B.OUTSIDE;w===B.INTERSECTING&&(i=!0)}return i?B.INTERSECTING:B.INSIDE};q.prototype.computeVisibilityWithPlaneMask=function(e,t){if(!o(e))throw new s("boundingVolume is required.");if(!o(t))throw new s("parentPlaneMask is required.");if(t===q.MASK_OUTSIDE||t===q.MASK_INSIDE)return t;for(var i=q.MASK_INSIDE,f=this.planes,h=0,w=f.length;h<w;++h){var _=h<31?1<<h:0;if(!(h<31&&(t&_)===0)){var m=e.intersectPlane(u.fromCartesian4(f[h],le));if(m===B.OUTSIDE)return q.MASK_OUTSIDE;m===B.INTERSECTING&&(i|=_)}}return i};q.MASK_OUTSIDE=4294967295;q.MASK_INSIDE=0;q.MASK_INDETERMINATE=2147483647;var oe=q;function V(e){e=d(e,d.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=d(e.near,1),this._near=this.near,this.far=d(e.far,5e8),this._far=this.far,this._cullingVolume=new oe,this._orthographicMatrix=new b}function de(e){if(!o(e.right)||!o(e.left)||!o(e.top)||!o(e.bottom)||!o(e.near)||!o(e.far))throw new s("right, left, top, bottom, near, or far parameters are not set.");if(e.top!==e._top||e.bottom!==e._bottom||e.left!==e._left||e.right!==e._right||e.near!==e._near||e.far!==e._far){if(e.left>e.right)throw new s("right must be greater than left.");if(e.bottom>e.top)throw new s("top must be greater than bottom.");if(e.near>e.far)throw new s("near must be greater than zero and less than far.");e._left=e.left,e._right=e.right,e._top=e.top,e._bottom=e.bottom,e._near=e.near,e._far=e.far,e._orthographicMatrix=b.computeOrthographicOffCenter(e.left,e.right,e.bottom,e.top,e.near,e.far,e._orthographicMatrix)}}Object.defineProperties(V.prototype,{projectionMatrix:{get:function(){return de(this),this._orthographicMatrix}}});var Oe=new a,xe=new a,Me=new a,he=new a;V.prototype.computeCullingVolume=function(e,t,i){if(!o(e))throw new s("position is required.");if(!o(t))throw new s("direction is required.");if(!o(i))throw new s("up is required.");var f=this._cullingVolume.planes,h=this.top,w=this.bottom,_=this.right,m=this.left,r=this.near,n=this.far,y=a.cross(t,i,Oe);a.normalize(y,y);var P=xe;a.multiplyByScalar(t,r,P),a.add(e,P,P);var l=Me;a.multiplyByScalar(y,m,l),a.add(P,l,l);var c=f[0];return o(c)||(c=f[0]=new g),c.x=y.x,c.y=y.y,c.z=y.z,c.w=-a.dot(y,l),a.multiplyByScalar(y,_,l),a.add(P,l,l),c=f[1],o(c)||(c=f[1]=new g),c.x=-y.x,c.y=-y.y,c.z=-y.z,c.w=-a.dot(a.negate(y,he),l),a.multiplyByScalar(i,w,l),a.add(P,l,l),c=f[2],o(c)||(c=f[2]=new g),c.x=i.x,c.y=i.y,c.z=i.z,c.w=-a.dot(i,l),a.multiplyByScalar(i,h,l),a.add(P,l,l),c=f[3],o(c)||(c=f[3]=new g),c.x=-i.x,c.y=-i.y,c.z=-i.z,c.w=-a.dot(a.negate(i,he),l),c=f[4],o(c)||(c=f[4]=new g),c.x=t.x,c.y=t.y,c.z=t.z,c.w=-a.dot(t,P),a.multiplyByScalar(t,n,l),a.add(e,l,l),c=f[5],o(c)||(c=f[5]=new g),c.x=-t.x,c.y=-t.y,c.z=-t.z,c.w=-a.dot(a.negate(t,he),l),this._cullingVolume};V.prototype.getPixelDimensions=function(e,t,i,f,h){if(de(this),!o(e)||!o(t))throw new s("Both drawingBufferWidth and drawingBufferHeight are required.");if(e<=0)throw new s("drawingBufferWidth must be greater than zero.");if(t<=0)throw new s("drawingBufferHeight must be greater than zero.");if(!o(i))throw new s("distance is required.");if(!o(f))throw new s("pixelRatio is required.");if(f<=0)throw new s("pixelRatio must be greater than zero.");if(!o(h))throw new s("A result object is required.");var w=this.right-this.left,_=this.top-this.bottom,m=f*w/e,r=f*_/t;return h.x=m,h.y=r,h};V.prototype.clone=function(e){return o(e)||(e=new V),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e};V.prototype.equals=function(e){return o(e)&&e instanceof V&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far};V.prototype.equalsEpsilon=function(e,t,i){return e===this||o(e)&&e instanceof V&&F.equalsEpsilon(this.right,e.right,t,i)&&F.equalsEpsilon(this.left,e.left,t,i)&&F.equalsEpsilon(this.top,e.top,t,i)&&F.equalsEpsilon(this.bottom,e.bottom,t,i)&&F.equalsEpsilon(this.near,e.near,t,i)&&F.equalsEpsilon(this.far,e.far,t,i)};var me=V;function R(e){e=d(e,d.EMPTY_OBJECT),this._offCenterFrustum=new me,this.width=e.width,this._width=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=d(e.near,1),this._near=this.near,this.far=d(e.far,5e8),this._far=this.far}R.packedLength=4;R.pack=function(e,t,i){return M.typeOf.object("value",e),M.defined("array",t),i=d(i,0),t[i++]=e.width,t[i++]=e.aspectRatio,t[i++]=e.near,t[i]=e.far,t};R.unpack=function(e,t,i){return M.defined("array",e),t=d(t,0),o(i)||(i=new R),i.width=e[t++],i.aspectRatio=e[t++],i.near=e[t++],i.far=e[t],i};function K(e){if(!o(e.width)||!o(e.aspectRatio)||!o(e.near)||!o(e.far))throw new s("width, aspectRatio, near, or far parameters are not set.");var t=e._offCenterFrustum;if(e.width!==e._width||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far){if(e.aspectRatio<0)throw new s("aspectRatio must be positive.");if(e.near<0||e.near>e.far)throw new s("near must be greater than zero and less than far.");e._aspectRatio=e.aspectRatio,e._width=e.width,e._near=e.near,e._far=e.far;var i=1/e.aspectRatio;t.right=e.width*.5,t.left=-t.right,t.top=i*t.right,t.bottom=-t.top,t.near=e.near,t.far=e.far}}Object.defineProperties(R.prototype,{projectionMatrix:{get:function(){return K(this),this._offCenterFrustum.projectionMatrix}}});R.prototype.computeCullingVolume=function(e,t,i){return K(this),this._offCenterFrustum.computeCullingVolume(e,t,i)};R.prototype.getPixelDimensions=function(e,t,i,f,h){return K(this),this._offCenterFrustum.getPixelDimensions(e,t,i,f,h)};R.prototype.clone=function(e){return o(e)||(e=new R),e.aspectRatio=this.aspectRatio,e.width=this.width,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._width=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e};R.prototype.equals=function(e){return!o(e)||!(e instanceof R)?!1:(K(this),K(e),this.width===e.width&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))};R.prototype.equalsEpsilon=function(e,t,i){return!o(e)||!(e instanceof R)?!1:(K(this),K(e),F.equalsEpsilon(this.width,e.width,t,i)&&F.equalsEpsilon(this.aspectRatio,e.aspectRatio,t,i)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,t,i))};var j=R;function S(e){e=d(e,d.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=d(e.near,1),this._near=this.near,this.far=d(e.far,5e8),this._far=this.far,this._cullingVolume=new oe,this._perspectiveMatrix=new b,this._infinitePerspective=new b}function pe(e){if(!o(e.right)||!o(e.left)||!o(e.top)||!o(e.bottom)||!o(e.near)||!o(e.far))throw new s("right, left, top, bottom, near, or far parameters are not set.");var t=e.top,i=e.bottom,f=e.right,h=e.left,w=e.near,_=e.far;if(t!==e._top||i!==e._bottom||h!==e._left||f!==e._right||w!==e._near||_!==e._far){if(e.near<=0||e.near>e.far)throw new s("near must be greater than zero and less than far.");e._left=h,e._right=f,e._top=t,e._bottom=i,e._near=w,e._far=_,e._perspectiveMatrix=b.computePerspectiveOffCenter(h,f,i,t,w,_,e._perspectiveMatrix),e._infinitePerspective=b.computeInfinitePerspectiveOffCenter(h,f,i,t,w,e._infinitePerspective)}}Object.defineProperties(S.prototype,{projectionMatrix:{get:function(){return pe(this),this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){return pe(this),this._infinitePerspective}}});var Re=new a,ze=new a,Te=new a,qe=new a;S.prototype.resetProjectionMatrix=function(){if(!o(this.right)||!o(this.left)||!o(this.top)||!o(this.bottom)||!o(this.near)||!o(this.far))throw new s("right, left, top, bottom, near, or far parameters are not set.");var e=this.top,t=this.bottom,i=this.right,f=this.left,h=this.near,w=this.far;if(this.near<=0||this.near>this.far)throw new s("near must be greater than zero and less than far.");this._left=f,this._right=i,this._top=e,this._bottom=t,this._near=h,this._far=w,this._perspectiveMatrix=b.computePerspectiveOffCenter(f,i,t,e,h,w,this._perspectiveMatrix),this._infinitePerspective=b.computeInfinitePerspectiveOffCenter(f,i,t,e,h,this._infinitePerspective)};S.prototype.computeCullingVolume=function(e,t,i,f){if(!o(e))throw new s("position is required.");if(!o(t))throw new s("direction is required.");if(!o(i))throw new s("up is required.");var h=this._cullingVolume.planes,w=d(f,0);w=Math.min(w,.5),w=Math.max(w,0);var _=this.top+this.top*w,m=this.bottom-this.top*w,r=this.right+this.right*w,n=this.left-this.right*w,y=this.near,P=this.far,l=a.cross(t,i,Re),c=ze;a.multiplyByScalar(t,y,c),a.add(e,c,c);var O=Te;a.multiplyByScalar(t,P,O),a.add(e,O,O);var p=qe;a.multiplyByScalar(l,n,p),a.add(c,p,p),a.subtract(p,e,p),a.normalize(p,p),a.cross(p,i,p),a.normalize(p,p);var v=h[0];return o(v)||(v=h[0]=new g),v.x=p.x,v.y=p.y,v.z=p.z,v.w=-a.dot(p,e),a.multiplyByScalar(l,r,p),a.add(c,p,p),a.subtract(p,e,p),a.cross(i,p,p),a.normalize(p,p),v=h[1],o(v)||(v=h[1]=new g),v.x=p.x,v.y=p.y,v.z=p.z,v.w=-a.dot(p,e),a.multiplyByScalar(i,m,p),a.add(c,p,p),a.subtract(p,e,p),a.cross(l,p,p),a.normalize(p,p),v=h[2],o(v)||(v=h[2]=new g),v.x=p.x,v.y=p.y,v.z=p.z,v.w=-a.dot(p,e),a.multiplyByScalar(i,_,p),a.add(c,p,p),a.subtract(p,e,p),a.cross(p,l,p),a.normalize(p,p),v=h[3],o(v)||(v=h[3]=new g),v.x=p.x,v.y=p.y,v.z=p.z,v.w=-a.dot(p,e),v=h[4],o(v)||(v=h[4]=new g),v.x=t.x,v.y=t.y,v.z=t.z,v.w=-a.dot(t,c),a.negate(t,p),v=h[5],o(v)||(v=h[5]=new g),v.x=p.x,v.y=p.y,v.z=p.z,v.w=-a.dot(p,O),this._cullingVolume};S.prototype.getPixelDimensions=function(e,t,i,f,h){if(pe(this),!o(e)||!o(t))throw new s("Both drawingBufferWidth and drawingBufferHeight are required.");if(e<=0)throw new s("drawingBufferWidth must be greater than zero.");if(t<=0)throw new s("drawingBufferHeight must be greater than zero.");if(!o(i))throw new s("distance is required.");if(!o(f))throw new s("pixelRatio is required");if(f<=0)throw new s("pixelRatio must be greater than zero.");if(!o(h))throw new s("A result object is required.");var w=1/this.near,_=this.top*w,m=2*f*i*_/t;_=this.right*w;var r=2*f*i*_/e;return h.x=r,h.y=m,h};S.prototype.clone=function(e){return o(e)||(e=new S),e.right=this.right,e.left=this.left,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e};S.prototype.equals=function(e){return o(e)&&e instanceof S&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far};S.prototype.equalsEpsilon=function(e,t,i){return e===this||o(e)&&e instanceof S&&F.equalsEpsilon(this.right,e.right,t,i)&&F.equalsEpsilon(this.left,e.left,t,i)&&F.equalsEpsilon(this.top,e.top,t,i)&&F.equalsEpsilon(this.bottom,e.bottom,t,i)&&F.equalsEpsilon(this.near,e.near,t,i)&&F.equalsEpsilon(this.far,e.far,t,i)};var ye=S;function x(e){e=d(e,d.EMPTY_OBJECT),this._offCenterFrustum=new ye,this.fov=e.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=d(e.near,1),this._near=this.near,this.far=d(e.far,5e8),this._far=this.far,this.xOffset=d(e.xOffset,0),this._xOffset=this.xOffset,this.yOffset=d(e.yOffset,0),this._yOffset=this.yOffset,this.reflect=!1}x.isNDCHalfZRange=!1;x.packedLength=6;x.pack=function(e,t,i){return M.typeOf.object("value",e),M.defined("array",t),i=d(i,0),t[i++]=e.fov,t[i++]=e.aspectRatio,t[i++]=e.near,t[i++]=e.far,t[i++]=e.xOffset,t[i]=e.yOffset,t};x.unpack=function(e,t,i){return M.defined("array",e),t=d(t,0),o(i)||(i=new x),i.fov=e[t++],i.aspectRatio=e[t++],i.near=e[t++],i.far=e[t++],i.xOffset=e[t++],i.yOffset=e[t],i};function k(e){if(!o(e.fov)||!o(e.aspectRatio)||!o(e.near)||!o(e.far))throw new s("fov, aspectRatio, near, or far parameters are not set.");var t=e._offCenterFrustum;if(e.fov!==e._fov||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far||e.xOffset!==e._xOffset||e.yOffset!==e._yOffset){if(e.fov<0||e.fov>=Math.PI)throw new s("fov must be in the range [0, PI).");if(e.aspectRatio<0)throw new s("aspectRatio must be positive.");if(e.near<0||e.near>e.far)throw new s("near must be greater than zero and less than far.");e._aspectRatio=e.aspectRatio,e._fov=e.fov,o(e._forcedFovy)?e._fovy=e._forcedFovy:e._fovy=e.aspectRatio<=1?e.fov:Math.atan(Math.tan(e.fov*.5)/e.aspectRatio)*2,e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset,t.top=e.near*Math.tan(.5*e._fovy),t.bottom=-t.top,t.right=e.aspectRatio*t.top,t.left=-t.right,t.near=e.near,t.far=e.far,t.right+=e.xOffset,t.left+=e.xOffset,t.top+=e.yOffset,t.bottom+=e.yOffset}}Object.defineProperties(x.prototype,{projectionMatrix:{get:function(){return k(this),this.reflect&&Se(this),this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){return k(this),this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){return k(this),this._fovy}},sseDenominator:{get:function(){return k(this),this._sseDenominator}}});x.prototype.resetProjectionMatrix=function(){return this._offCenterFrustum.resetProjectionMatrix()};x.prototype.computeCullingVolume=function(e,t,i,f){return k(this),this._offCenterFrustum.computeCullingVolume(e,t,i,f)};x.prototype.getPixelDimensions=function(e,t,i,f,h){return k(this),this._offCenterFrustum.getPixelDimensions(e,t,i,f,h)};x.prototype.clone=function(e){return o(e)||(e=new x),e.aspectRatio=this.aspectRatio,e.fov=this.fov,e.near=this.near,e.far=this.far,e.reflect=this.reflect,e.clipPlane=this.clipPlane,e.currentViewMatrix=this.currentViewMatrix,e._aspectRatio=void 0,e._fov=void 0,e._near=void 0,e._far=void 0,e._forcedFovy=this._forcedFovy,this._offCenterFrustum.clone(e._offCenterFrustum),e};x.prototype.equals=function(e){return!o(e)||!(e instanceof x)?!1:(k(this),k(e),this.fov===e.fov&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))};x.prototype.equalsEpsilon=function(e,t,i){return!o(e)||!(e instanceof x)?!1:(k(this),k(e),F.equalsEpsilon(this.fov,e.fov,t,i)&&F.equalsEpsilon(this.aspectRatio,e.aspectRatio,t,i)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,t,i))};x.prototype.setForcedFovy=function(e){this._forcedFovy=e};var Y=new u(a.UNIT_Z,1),ie=new g,I=new g,re=new g;function Se(e){if(!(!o(e.clipPlane)||!o(e.currentViewMatrix))){var t=e.currentViewMatrix,i=e._offCenterFrustum.projectionMatrix;b.multiplyByPlane(t,e.clipPlane,Y),ie.x=(F.sign(Y.normal.x)+i[8])/i[0],ie.y=(F.sign(Y.normal.y)+i[9])/i[5],ie.z=-1,ie.w=(1+i[10])/i[14],I.x=Y.normal.x,I.y=Y.normal.y,I.z=Y.normal.z,I.w=Y.distance,g.multiplyByScalar(I,2/g.dot(I,ie),re),i[2]=re.x,i[6]=re.y,i[10]=re.z+1,i[14]=re.w,b.halfZRange&&b.multiply(b.ConvertNDCToHalfZRange,i,i)}}var U=x;var fe=0,De=1;function G(e){M.typeOf.object("options",e),M.typeOf.object("options.frustum",e.frustum),M.typeOf.object("options.origin",e.origin),M.typeOf.object("options.orientation",e.orientation);var t=e.frustum,i=e.orientation,f=e.origin,h=d(e.vertexFormat,E.DEFAULT),w=d(e._drawNearPlane,!0),_,m;t instanceof U?(_=fe,m=U.packedLength):t instanceof j&&(_=De,m=j.packedLength),this._frustumType=_,this._frustum=t.clone(),this._origin=a.clone(f),this._orientation=A.clone(i),this._drawNearPlane=w,this._vertexFormat=h,this._workerName="createFrustumGeometry",this.packedLength=2+m+a.packedLength+A.packedLength+E.packedLength}G.pack=function(e,t,i){M.typeOf.object("value",e),M.defined("array",t),i=d(i,0);var f=e._frustumType,h=e._frustum;return t[i++]=f,f===fe?(U.pack(h,t,i),i+=U.packedLength):(j.pack(h,t,i),i+=j.packedLength),a.pack(e._origin,t,i),i+=a.packedLength,A.pack(e._orientation,t,i),i+=A.packedLength,E.pack(e._vertexFormat,t,i),i+=E.packedLength,t[i]=e._drawNearPlane?1:0,t};var Ve=new U,ke=new j,Ae=new A,Ee=new a,Ne=new E;G.unpack=function(e,t,i){M.defined("array",e),t=d(t,0);var f=e[t++],h;f===fe?(h=U.unpack(e,t,Ve),t+=U.packedLength):(h=j.unpack(e,t,ke),t+=j.packedLength);var w=a.unpack(e,t,Ee);t+=a.packedLength;var _=A.unpack(e,t,Ae);t+=A.packedLength;var m=E.unpack(e,t,Ne);t+=E.packedLength;var r=e[t]===1;if(!o(i))return new G({frustum:h,origin:w,orientation:_,vertexFormat:m,_drawNearPlane:r});var n=f===i._frustumType?i._frustum:void 0;return i._frustum=h.clone(n),i._frustumType=f,i._origin=a.clone(w,i._origin),i._orientation=A.clone(_,i._orientation),i._vertexFormat=E.clone(m,i._vertexFormat),i._drawNearPlane=r,i};function ee(e,t,i,f,h,w,_,m){for(var r=e/3*2,n=0;n<4;++n)o(t)&&(t[e]=w.x,t[e+1]=w.y,t[e+2]=w.z),o(i)&&(i[e]=_.x,i[e+1]=_.y,i[e+2]=_.z),o(f)&&(f[e]=m.x,f[e+1]=m.y,f[e+2]=m.z),e+=3;h[r]=0,h[r+1]=0,h[r+2]=1,h[r+3]=0,h[r+4]=1,h[r+5]=1,h[r+6]=0,h[r+7]=1}var Be=new W,Le=new b,ce=new b,ge=new a,Ce=new a,Pe=new a,je=new a,Ue=new a,He=new a,H=new Array(3),ae=new Array(4);ae[0]=new g(-1,-1,1,1);ae[1]=new g(1,-1,1,1);ae[2]=new g(1,1,1,1);ae[3]=new g(-1,1,1,1);var be=new Array(4);for(ne=0;ne<4;++ne)be[ne]=new g;var ne;G._computeNearFarPlanes=function(e,t,i,f,h,w,_,m){var r=W.fromQuaternion(t,Be),n=d(w,ge),y=d(_,Ce),P=d(m,Pe);n=W.getColumn(r,0,n),y=W.getColumn(r,1,y),P=W.getColumn(r,2,P),a.normalize(n,n),a.normalize(y,y),a.normalize(P,P),a.negate(n,n);var l=b.computeView(e,P,y,n,Le),c,O;if(i===fe){var p=f.projectionMatrix,v=b.multiply(p,l,ce);O=b.inverse(v,ce)}else c=b.inverseTransformation(l,ce);o(O)?(H[0]=f.near,H[1]=f.far):(H[0]=0,H[1]=f.near,H[2]=f.far);for(var z=0;z<2;++z)for(var T=0;T<4;++T){var C=g.clone(ae[T],be[T]);if(o(O)){C=b.multiplyByVector(O,C,C);var J=1/C.w;a.multiplyByScalar(C,J,C),a.subtract(C,e,C),a.normalize(C,C);var N=a.dot(P,C);a.multiplyByScalar(C,H[z]/N,C),a.add(C,e,C)}else{o(f._offCenterFrustum)&&(f=f._offCenterFrustum);var Z=H[z],D=H[z+1];C.x=(C.x*(f.right-f.left)+f.left+f.right)*.5,C.y=(C.y*(f.top-f.bottom)+f.bottom+f.top)*.5,C.z=(C.z*(Z-D)-Z-D)*.5,C.w=1,b.multiplyByVector(c,C,C)}h[12*z+T*3]=C.x,h[12*z+T*3+1]=C.y,h[12*z+T*3+2]=C.z}};G.createGeometry=function(e){var t=e._frustumType,i=e._frustum,f=e._origin,h=e._orientation,w=e._drawNearPlane,_=e._vertexFormat,m=w?6:5,r=new Float64Array(3*4*6);G._computeNearFarPlanes(f,h,t,i,r);var n=3*4*2;r[n]=r[3*4],r[n+1]=r[3*4+1],r[n+2]=r[3*4+2],r[n+3]=r[0],r[n+4]=r[1],r[n+5]=r[2],r[n+6]=r[3*3],r[n+7]=r[3*3+1],r[n+8]=r[3*3+2],r[n+9]=r[3*7],r[n+10]=r[3*7+1],r[n+11]=r[3*7+2],n+=3*4,r[n]=r[3*5],r[n+1]=r[3*5+1],r[n+2]=r[3*5+2],r[n+3]=r[3],r[n+4]=r[3+1],r[n+5]=r[3+2],r[n+6]=r[0],r[n+7]=r[1],r[n+8]=r[2],r[n+9]=r[3*4],r[n+10]=r[3*4+1],r[n+11]=r[3*4+2],n+=3*4,r[n]=r[3],r[n+1]=r[3+1],r[n+2]=r[3+2],r[n+3]=r[3*5],r[n+4]=r[3*5+1],r[n+5]=r[3*5+2],r[n+6]=r[3*6],r[n+7]=r[3*6+1],r[n+8]=r[3*6+2],r[n+9]=r[3*2],r[n+10]=r[3*2+1],r[n+11]=r[3*2+2],n+=3*4,r[n]=r[3*2],r[n+1]=r[3*2+1],r[n+2]=r[3*2+2],r[n+3]=r[3*6],r[n+4]=r[3*6+1],r[n+5]=r[3*6+2],r[n+6]=r[3*7],r[n+7]=r[3*7+1],r[n+8]=r[3*7+2],r[n+9]=r[3*3],r[n+10]=r[3*3+1],r[n+11]=r[3*3+2],w||(r=r.subarray(3*4));var y=new se({position:new $({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:r})});if(o(_.normal)||o(_.tangent)||o(_.bitangent)||o(_.st)){var P=o(_.normal)?new Float32Array(12*m):void 0,l=o(_.tangent)?new Float32Array(3*4*m):void 0,c=o(_.bitangent)?new Float32Array(3*4*m):void 0,O=o(_.st)?new Float32Array(2*4*m):void 0,p=ge,v=Ce,z=Pe,T=a.negate(p,je),C=a.negate(v,Ue),Z=a.negate(z,He);n=0,w&&(ee(n,P,l,c,O,Z,p,v),n+=3*4),ee(n,P,l,c,O,z,T,v),n+=3*4,ee(n,P,l,c,O,T,Z,v),n+=3*4,ee(n,P,l,c,O,C,Z,T),n+=3*4,ee(n,P,l,c,O,p,z,v),n+=3*4,ee(n,P,l,c,O,v,z,T),o(P)&&(y.normal=new $({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:P})),o(l)&&(y.tangent=new $({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:l})),o(c)&&(y.bitangent=new $({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:c})),o(O)&&(y.st=new $({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:O}))}for(var D=new Uint16Array(6*m),J=0;J<m;++J){var N=J*6,Q=J*4;D[N]=Q,D[N+1]=Q+1,D[N+2]=Q+2,D[N+3]=Q,D[N+4]=Q+2,D[N+5]=Q+3}return new _e({attributes:y,indices:D,primitiveType:we.TRIANGLES,boundingSphere:ve.fromVertices(r)})};var Xt=G;export{j as a,U as b,Xt as c};
